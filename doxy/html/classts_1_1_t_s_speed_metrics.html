<!-- HTML header for doxygen 1.8.12-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TSDuck: ts::TSSpeedMetrics Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxy-style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img src="tsduck-32.png"/></td>
   <td id="projectalign"><span id="projectname">TSDuck</span>
    <span id="projectnumber">Version 3.11-710</span>
    <span id="projectbrief">(TSDuck - The MPEG Transport Stream Toolkit)</span>
   </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classts_1_1_t_s_speed_metrics.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classts_1_1_t_s_speed_metrics-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ts::TSSpeedMetrics Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>TS processing speed metrics evaluation.  
 <a href="classts_1_1_t_s_speed_metrics.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a43cddcc347956d559b09ac3674e9ad82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classts_1_1_t_s_speed_metrics.html#a43cddcc347956d559b09ac3674e9ad82">TSSpeedMetrics</a> (<a class="el" href="namespacets.html#a9cdec7a120783847f53fbf71e5eb49f6">PacketCounter</a> packets=<a class="el" href="classts_1_1_t_s_speed_metrics.html#ad1b0d6b18a266af7a4117306addc88ee">MIN_PACKET_PER_INTERVAL</a>, <a class="el" href="namespacets.html#acd890ba84c12ced734201afae32a3e95">NanoSecond</a> nanosecs=<a class="el" href="classts_1_1_t_s_speed_metrics.html#a928ea896a88e6c26c15c82d353b18e88">MIN_NANOSEC_PER_INTERVAL</a>, size_t intervals=<a class="el" href="classts_1_1_t_s_speed_metrics.html#a9b40a51816a01045555c6591a9aebb8e">INTERVAL_COUNT</a>)</td></tr>
<tr class="memdesc:a43cddcc347956d559b09ac3674e9ad82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a43cddcc347956d559b09ac3674e9ad82">More...</a><br /></td></tr>
<tr class="separator:a43cddcc347956d559b09ac3674e9ad82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0b1ffe74cda132839b9bf8626d0ac5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacets.html#ab979eee2ee2eef80c6f655146d4c3961">BitRate</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classts_1_1_t_s_speed_metrics.html#aca0b1ffe74cda132839b9bf8626d0ac5">bitrate</a> () const</td></tr>
<tr class="memdesc:aca0b1ffe74cda132839b9bf8626d0ac5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the evaluated processing bitrate in bits/second based on 188-byte packets.  <a href="#aca0b1ffe74cda132839b9bf8626d0ac5">More...</a><br /></td></tr>
<tr class="separator:aca0b1ffe74cda132839b9bf8626d0ac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d42a32574196e396741782c003d5abd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classts_1_1_t_s_speed_metrics.html#a1d42a32574196e396741782c003d5abd">processedPacket</a> (<a class="el" href="namespacets.html#a9cdec7a120783847f53fbf71e5eb49f6">PacketCounter</a> count=1)</td></tr>
<tr class="memdesc:a1d42a32574196e396741782c003d5abd"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classts_1_1_report.html" title="Abstract interface for event reporting and monitoring. ">Report</a> the processing of some TS packets by the application.  <a href="#a1d42a32574196e396741782c003d5abd">More...</a><br /></td></tr>
<tr class="separator:a1d42a32574196e396741782c003d5abd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41e40dc188dd5187095120cbd439698f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacets.html#acd890ba84c12ced734201afae32a3e95">NanoSecond</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classts_1_1_t_s_speed_metrics.html#a41e40dc188dd5187095120cbd439698f">sessionNanoSeconds</a> () const</td></tr>
<tr class="memdesc:a41e40dc188dd5187095120cbd439698f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the duration of the session, since <a class="el" href="classts_1_1_t_s_speed_metrics.html#a4c4996bd3c48eea9ea3fbe894c9ef694" title="Start a new processing time session. ">start()</a>, in nanoseconds.  <a href="#a41e40dc188dd5187095120cbd439698f">More...</a><br /></td></tr>
<tr class="separator:a41e40dc188dd5187095120cbd439698f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c4996bd3c48eea9ea3fbe894c9ef694"><td class="memItemLeft" align="right" valign="top"><a id="a4c4996bd3c48eea9ea3fbe894c9ef694"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classts_1_1_t_s_speed_metrics.html#a4c4996bd3c48eea9ea3fbe894c9ef694">start</a> ()</td></tr>
<tr class="memdesc:a4c4996bd3c48eea9ea3fbe894c9ef694"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start a new processing time session. <br /></td></tr>
<tr class="separator:a4c4996bd3c48eea9ea3fbe894c9ef694"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a9b40a51816a01045555c6591a9aebb8e"><td class="memItemLeft" align="right" valign="top">static const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classts_1_1_t_s_speed_metrics.html#a9b40a51816a01045555c6591a9aebb8e">INTERVAL_COUNT</a> = 20</td></tr>
<tr class="memdesc:a9b40a51816a01045555c6591a9aebb8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default number of intervals in the sliding window of bitrate computation.  <a href="#a9b40a51816a01045555c6591a9aebb8e">More...</a><br /></td></tr>
<tr class="separator:a9b40a51816a01045555c6591a9aebb8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a928ea896a88e6c26c15c82d353b18e88"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="namespacets.html#acd890ba84c12ced734201afae32a3e95">NanoSecond</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classts_1_1_t_s_speed_metrics.html#a928ea896a88e6c26c15c82d353b18e88">MIN_NANOSEC_PER_INTERVAL</a> = 100 * <a class="el" href="namespacets.html#a1e6152f80180efe63539259baba67b6b">NanoSecPerMilliSec</a></td></tr>
<tr class="memdesc:a928ea896a88e6c26c15c82d353b18e88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default minimum number of nanoseconds per interval.  <a href="#a928ea896a88e6c26c15c82d353b18e88">More...</a><br /></td></tr>
<tr class="separator:a928ea896a88e6c26c15c82d353b18e88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b0d6b18a266af7a4117306addc88ee"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="namespacets.html#a9cdec7a120783847f53fbf71e5eb49f6">PacketCounter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classts_1_1_t_s_speed_metrics.html#ad1b0d6b18a266af7a4117306addc88ee">MIN_PACKET_PER_INTERVAL</a> = 100</td></tr>
<tr class="memdesc:ad1b0d6b18a266af7a4117306addc88ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default minimum packets to accumulate per interval.  <a href="#ad1b0d6b18a266af7a4117306addc88ee">More...</a><br /></td></tr>
<tr class="separator:ad1b0d6b18a266af7a4117306addc88ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>TS processing speed metrics evaluation. </p>
<p>An instance of this class evaluates the reading or processing speed of a TS. This is different from the TS bitrate, as evaluated by the class <a class="el" href="classts_1_1_p_c_r_analyzer.html" title="PCR statistics analysis. ">PCRAnalyzer</a>, when the TS is not a live one but a file for instance.</p>
<p>This class is useful to perform actions at regular intervals, based on wall clock time, not TS clock. Instead of checking the system time at every packet, which is far from efficient, an application can predict an average number of packets to process before performing the repetitive action.</p>
<p>Warning: The processing speed of the TS is typically not stable. Buffer sizes impact the latency for instance. As well as any external factor in the operating system. So, predictions on packet distance are only hints at best. This class shall be considered as an optimization on the number of times the system time is probed, not a precise prediction.</p>
<p>Principle of operation:</p><ul>
<li>We work on a monotonic clock and we count packets.</li>
<li>We compute an "current" processing bitrate, not an average bitrate from the beginning.</li>
<li>The bitrate is computed over the last period of at least 2 seconds and at least 2000 packets (default values).</li>
<li>This "current period" is in fact made of a sliding windows of 20 elementary interval. Each interval must extend over at least 100 packets and 100 milliseconds. </li>
</ul>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a43cddcc347956d559b09ac3674e9ad82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43cddcc347956d559b09ac3674e9ad82">&#9670;&nbsp;</a></span>TSSpeedMetrics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ts::TSSpeedMetrics::TSSpeedMetrics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacets.html#a9cdec7a120783847f53fbf71e5eb49f6">PacketCounter</a>&#160;</td>
          <td class="paramname"><em>packets</em> = <code><a class="el" href="classts_1_1_t_s_speed_metrics.html#ad1b0d6b18a266af7a4117306addc88ee">MIN_PACKET_PER_INTERVAL</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacets.html#acd890ba84c12ced734201afae32a3e95">NanoSecond</a>&#160;</td>
          <td class="paramname"><em>nanosecs</em> = <code><a class="el" href="classts_1_1_t_s_speed_metrics.html#a928ea896a88e6c26c15c82d353b18e88">MIN_NANOSEC_PER_INTERVAL</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>intervals</em> = <code><a class="el" href="classts_1_1_t_s_speed_metrics.html#a9b40a51816a01045555c6591a9aebb8e">INTERVAL_COUNT</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">packets</td><td>Minimum packets to accumulate per interval. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nanosecs</td><td>Minimum number of nanoseconds per interval. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">intervals</td><td>Max number of sliding time intervals. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1d42a32574196e396741782c003d5abd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d42a32574196e396741782c003d5abd">&#9670;&nbsp;</a></span>processedPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ts::TSSpeedMetrics::processedPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacets.html#a9cdec7a120783847f53fbf71e5eb49f6">PacketCounter</a>&#160;</td>
          <td class="paramname"><em>count</em> = <code>1</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classts_1_1_report.html" title="Abstract interface for event reporting and monitoring. ">Report</a> the processing of some TS packets by the application. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">count</td><td>Number of processed packets, one by default. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if we just fetched the value of the clock. </dd></dl>

</div>
</div>
<a id="aca0b1ffe74cda132839b9bf8626d0ac5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca0b1ffe74cda132839b9bf8626d0ac5">&#9670;&nbsp;</a></span>bitrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacets.html#ab979eee2ee2eef80c6f655146d4c3961">BitRate</a> ts::TSSpeedMetrics::bitrate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the evaluated processing bitrate in bits/second based on 188-byte packets. </p>
<dl class="section return"><dt>Returns</dt><dd>The evaluated TS bitrate in bits/second or zero if not available. </dd></dl>

</div>
</div>
<a id="a41e40dc188dd5187095120cbd439698f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41e40dc188dd5187095120cbd439698f">&#9670;&nbsp;</a></span>sessionNanoSeconds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacets.html#acd890ba84c12ced734201afae32a3e95">NanoSecond</a> ts::TSSpeedMetrics::sessionNanoSeconds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the duration of the session, since <a class="el" href="classts_1_1_t_s_speed_metrics.html#a4c4996bd3c48eea9ea3fbe894c9ef694" title="Start a new processing time session. ">start()</a>, in nanoseconds. </p>
<p>The value is the most precise when <a class="el" href="classts_1_1_t_s_speed_metrics.html#a1d42a32574196e396741782c003d5abd" title="Report the processing of some TS packets by the application. ">processedPacket()</a> just returned true. </p><dl class="section return"><dt>Returns</dt><dd>The duration of the session, since <a class="el" href="classts_1_1_t_s_speed_metrics.html#a4c4996bd3c48eea9ea3fbe894c9ef694" title="Start a new processing time session. ">start()</a>, in nanoseconds. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ad1b0d6b18a266af7a4117306addc88ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1b0d6b18a266af7a4117306addc88ee">&#9670;&nbsp;</a></span>MIN_PACKET_PER_INTERVAL</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespacets.html#a9cdec7a120783847f53fbf71e5eb49f6">PacketCounter</a> ts::TSSpeedMetrics::MIN_PACKET_PER_INTERVAL = 100</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default minimum packets to accumulate per interval. </p>
<p>See the description of the class. </p>

</div>
</div>
<a id="a928ea896a88e6c26c15c82d353b18e88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a928ea896a88e6c26c15c82d353b18e88">&#9670;&nbsp;</a></span>MIN_NANOSEC_PER_INTERVAL</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespacets.html#acd890ba84c12ced734201afae32a3e95">NanoSecond</a> ts::TSSpeedMetrics::MIN_NANOSEC_PER_INTERVAL = 100 * <a class="el" href="namespacets.html#a1e6152f80180efe63539259baba67b6b">NanoSecPerMilliSec</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default minimum number of nanoseconds per interval. </p>
<p>See the description of the class. </p>

</div>
</div>
<a id="a9b40a51816a01045555c6591a9aebb8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b40a51816a01045555c6591a9aebb8e">&#9670;&nbsp;</a></span>INTERVAL_COUNT</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const size_t ts::TSSpeedMetrics::INTERVAL_COUNT = 20</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default number of intervals in the sliding window of bitrate computation. </p>
<p>See the description of the class. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="ts_t_s_speed_metrics_8h.html">tsTSSpeedMetrics.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.12-->
<!-- start footer part -->
</body>
</html>
